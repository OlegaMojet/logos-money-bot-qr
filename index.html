<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>QR –°–∫–∞–Ω–µ—Ä</title>
</head>
<body style="font-family:sans-serif;text-align:center;padding:40px;background:#f0f0f0;">
    <h1>üì± QR –¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤</h1>
    <div id="status">–°–∫–∞–Ω–∏—Ä—É—é...</div>
    <div id="qrResult" style="display:none;font-size:20px;margin:20px;padding:20px;background:white;border-radius:10px;"></div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –µ—Å–ª–∏ startapp=qrscan
        if (tg.initDataUnsafe.start_param === 'qrscan' || tg.initDataUnsafe.start_app === 'qrscan') {
            tg.showScanQrPopup({text: '–ù–∞–≤–µ–¥–∏ –Ω–∞ QR'}, (qr) => {
                if (qr) {
                    document.getElementById('qrResult').textContent = qr;
                    document.getElementById('qrResult').style.display = 'block';
                    document.getElementById('status').textContent = '–ì–æ—Ç–æ–≤–æ!';
                    tg.MainButton.setText('‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å').show();
                }
                return !!qr;
            });
        } else {
            document.getElementById('status').innerHTML = '<button onclick="location.reload()">üîÑ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–∞–Ω–µ—Ä</button>';
        }

        tg.MainButton.onClick(() => tg.sendData(document.getElementById('qrResult').textContent || ''));
    </script>
</body>
</html>
